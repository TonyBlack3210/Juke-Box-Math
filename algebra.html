<script>
    let prob = {};

    function generate() {
        // No image swap here - keeping it steady!
        const cop = Math.floor(Math.random() * 10) + 2; 
        const factor = Math.floor(Math.random() * 8) + 2;
        const result = cop * factor;
        prob = { x: cop, f: factor, r: result };
        
        document.getElementById('equation').innerHTML = `${factor}x = ${result}`;
        document.getElementById('step-text').innerHTML = `To find x, treat it like a ratio! If <b>${factor}</b> groups equal <b>${result}</b>, we need to find the value of <b>1</b> group (the <b>C.O.P.</b>). <br><br>Divide the total (<b>${result}</b>) by the factor (<b>${factor}</b>) to isolate x!`;
        
        document.getElementById('feedback').innerText = "";
        document.getElementById('user-ans').value = "";
        document.getElementById('explanation-tab').style.display = 'none';
    }

    function check() {
        const ans = document.getElementById('user-ans').value;
        const feed = document.getElementById('feedback');

        if (parseInt(ans) === prob.x) {
            feed.innerText = "✅ Correct! You found the C.O.P.";
            feed.style.color = "green";
            // Stay on the same picture, just generate a new problem after 3 seconds
            setTimeout(generate, 3000);
        } else {
            feed.innerText = "❌ Not quite. Use the explanation button!";
            feed.style.color = "red";
        }
    }

    function toggleHelp() {
        const tab = document.getElementById('explanation-tab');
        tab.style.display = tab.style.display === 'block' ? 'none' : 'block';
    }

    window.onload = generate;
</script>

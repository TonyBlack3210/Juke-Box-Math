<script>
    let prob = {};
    const face = document.getElementById('teacher-face');

    function generate() {
        face.src = "mr-black-thinking.jpg";
        
        // Randomly pick cat/dog ratio
        const r1 = Math.floor(Math.random() * 4) + 2; 
        const r2 = Math.floor(Math.random() * 4) + 2; 
        const mult = Math.floor(Math.random() * 8) + 3; 
        
        // Decide which "type" of question to ask (0 = Total, 1 = Partner)
        const qType = Math.floor(Math.random() * 2);
        
        prob = { r1, r2, mult, type: qType };

        const questionBox = document.getElementById('question-text');

        if (qType === 0) {
            // Type 0: The "Total" question you already have
            const total = (r1 + r2) * mult;
            prob.targetCats = r1 * mult;
            prob.targetDogs = r2 * mult;
            questionBox.innerHTML = `If there are <b>${r1} cats</b> for every <b>${r2} dogs</b>, and there are <b>${total} total animals</b>... <br>How many are cats and how many are dogs?`;
        } else {
            // Type 1: The "Partner" question (If there are 24 cats...)
            const givenCats = r1 * mult;
            prob.targetCats = givenCats;
            prob.targetDogs = r2 * mult;
            questionBox.innerHTML = `The ratio of cats to dogs is <b>${r1} to ${r2}</b>. <br>If there are <b>${givenCats} cats</b>, how many dogs are there?`;
        }
        
        document.getElementById('feedback').innerText = "";
        document.getElementById('ans-cats').value = "";
        document.getElementById('ans-dogs').value = "";
    }

    function check() {
        const c = document.getElementById('ans-cats').value;
        const d = document.getElementById('ans-dogs').value;
        const feed = document.getElementById('feedback');
        
        if (parseInt(c) === prob.targetCats && parseInt(d) === prob.targetDogs) {
            feed.innerText = "✅ Excellent work! You nailed the ratio.";
            feed.style.color = "green";
            face.src = "mr-black-happy.jpg";
            setTimeout(generate, 3500);
        } else {
            feed.innerText = "❌ Not quite. Remember to find the multiplier first!";
            feed.style.color = "red";
            face.src = "mr-black-thinking.jpg";
        }
    }

    window.onload = generate;
</script>
